# SwiftLint Code Quality Check
# Runs on Ubuntu for faster execution, inspired by macos-auto-clicker-main

name: SwiftLint

on:
  push:
    branches: [ main, staging, dev ]
    paths:
      - '**/*.swift'
      - '.swiftlint.yml'
      - '.github/workflows/swiftlint.yml'
  pull_request:
    branches: [ main, staging, dev ]
    paths:
      - '**/*.swift'
      - '.swiftlint.yml'
      - '.github/workflows/swiftlint.yml'

# Cancel previous runs when new commits are pushed
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  swiftlint:
    name: ğŸ” SwiftLint
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 1  # Only need current commit for linting
      
      - name: ğŸ”§ Install SwiftLint
        run: |
          # Install SwiftLint using the official install script
          curl -sSL https://github.com/realm/SwiftLint/releases/latest/download/swiftlint_linux.zip -o swiftlint.zip
          unzip -o swiftlint.zip
          sudo mv swiftlint /usr/local/bin/
          swiftlint version
      
      - name: ğŸ” Run SwiftLint
        run: |
          echo "ğŸ” Running SwiftLint with strict enforcement..."
          swiftlint lint --strict --reporter github-actions-logging
          echo "âœ… SwiftLint passed successfully!"
      
      - name: ğŸ“Š SwiftLint Summary
        if: always()
        run: |
          echo "ğŸ“‹ SwiftLint Analysis Complete"
          echo "ğŸ¯ Configuration: .swiftlint.yml"
          echo "ğŸ“ Scanned: Sources/"
          echo "ğŸ”§ Mode: Strict (warnings = errors)"